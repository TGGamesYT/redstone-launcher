<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redstone Launcher - Player Manager</title>
  <link rel="stylesheet" href="server.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
<div id="toolbar">
<div class="drag-region">Redstone Launcher - Player Manager</div>
<div class="toolbar-buttons">
    <button id="min-btn">—</button>
    <button id="max-btn">□</button>
    <button id="close-btn">✕</button>
</div>
</div>
<div class="sidebar">
  <!-- Top section -->
  <ul class="menu top">
    <li><a href="index.html"><i class="material-icons">home</i></a><span>Home</span></li>
    <li><a href="instances.html"><i class="material-icons">play_arrow</i></a><span>Play</span></li>
    <li><a href="modrinth.html"><img src="https://tggamesyt.dev/assets/modrinth_icon.png" style="width: 24px;"></a><span>Modrinth</span></li>
    <li><a href="server.html"><i class="material-icons">storage</i></a><span>Server Manager</span></li>
    <li><a href="settings.html"><i class="material-icons">settings</i></a><span>Settings</span></li>
    <li><a href="players.html"><i class="material-icons">person</i></a><span>Profiles</span></li>
    <li><a href="profile-manager.html"><i class="material-icons">face</i></a><span>Skin, cape changer</span></li>
  </ul>

  <!-- Middle section (instances) -->
  <ul class="menu middle" id="instances">
    <li><i class="material-icons">add</i><span>Add an instance</span></li>
  </ul>

  <!-- Bottom section -->
  <ul class="menu bottom">
    <li><i class="material-icons">download</i><span>Download the latest update</span></li>
    <li id="players-login"><a href="players.html"><i class="material-icons">login</i></a><span>Login</span></li>
    <li><i class="material-icons" onclick="closeApp()">exit_to_app</i><span>Exit the launcher</span></li>
  </ul>
</div>
<canvas id="skin_container"></canvas>
<script>
players = [];
      const { ipcRenderer } = require('electron');
      async function getSelectedPlayer() {return await ipcRenderer.invoke('get-selected-player')}
      const skinview3d = require("skinview3d");
      selectedplayer = getSelectedPlayer

  async function updateSKin() {
    selectedplayer = await getSelectedPlayer();
    const player = players.find(p => p.id === selectedPlayerId);
    let name;
    if (!player.auth || !player.auth.name) {
      name = player.username;
    } else {
      name = player.auth.name;
    }
    skinViewer = new skinview3d.SkinViewer({
      canvas: document.getElementById("skin_container"),
      skin: `https://minotar.net/skin/${name}`,
      width: 600,
      height: 800
    });
    skinViewer.loadPanorama("https://skinview3d-demo.vercel.app/img/panorama.png");
  }

	// Load a cape
	//skinViewer.loadCape("img/cape.png");
    ipcRenderer.send("get-players");
  ipcRenderer.on("players-list", (event, newPlayers) => { players = newPlayers; updateSKin(); });
  ipcRenderer.on("players-updated", (event, newPlayers) => { players = newPlayers; updateSKin(); });
</script>
  <script src="sidebar.js"></script>
  </div>
</body>
</html>
