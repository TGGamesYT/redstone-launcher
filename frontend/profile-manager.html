<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redstone Launcher - Player Manager</title>
  <link rel="stylesheet" href="server.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
<div id="toolbar">
  <div class="toolbar-buttons-left">
      <button id="backBtn">⬅</button>
      <button id="forwardBtn">➡</button>
  </div>
<div class="drag-region">Redstone Launcher</div>
<div class="toolbar-buttons">
    <button id="min-btn">—</button>
    <button id="max-btn">◻</button>
    <button id="close-btn">✕</button>
</div>
</div>
<div class="sidebar">
  <ul class="menu top">
    <a href="index.html"><li><i class="material-icons">home</i><span>Home</span></li></a>
    <a href="instances.html"><li><i class="material-icons">play_arrow</i><span>Instances</span></li></a>
    <a href="modrinth.html" class="modrinth"><li><span>Modrinth</span></li></a>
    <a href="server.html"><li><i class="material-icons">storage</i><span>Server Manager</span></li></a>
  </ul>
  <ul class="menu middle" id="instances">
    <li><i class="material-icons">add</i><span>Add an instance</span></li>
  </ul>
  <ul class="menu bottom">
    <li id="update"><i class="material-icons">download</i><span id="updateText">Download the latest update</span></li>
    <li><a href="profile-manager.html"><i class="material-icons">face</i></a><span>Skin, cape changer</span></li>
    <a href="players.html"><li id="players-login"><i class="material-icons">login</i><span>Login</span></li></a>
    <li><a href="settings.html"><i class="material-icons">settings</i></a><span>Settings</span></li>
  </ul>
</div>
<canvas id="skin_container"></canvas>
<script>
players = [];
      const { ipcRenderer } = require('electron');
      async function getSelectedPlayer() {return await ipcRenderer.invoke('get-selected-player')}
      const skinview3d = require("skinview3d");
      selectedplayer = getSelectedPlayer

  async function updateSKin() {
    selectedplayer = await getSelectedPlayer();
    const player = players.find(p => p.id === selectedPlayerId);
    let name;
    if (!player.auth || !player.auth.name) {
      name = player.username;
    } else {
      name = player.auth.name;
    }
    skinViewer = new skinview3d.SkinViewer({
      canvas: document.getElementById("skin_container"),
      skin: `https://minotar.net/skin/${name}`,
      width: 600,
      height: 800
    });
    skinViewer.loadPanorama("https://skinview3d-demo.vercel.app/img/panorama.png");
  }

	// Load a cape
	//skinViewer.loadCape("img/cape.png");
    ipcRenderer.send("get-players");
  ipcRenderer.on("players-list", (event, newPlayers) => { players = newPlayers; updateSKin(); });
  ipcRenderer.on("players-updated", (event, newPlayers) => { players = newPlayers; updateSKin(); });
function updatePresence(details, state = "Idle") {
  ipcRenderer.send('update-discord-presence', { details, state });
}
updatePresence("Managing skins")
</script>
  <script src="sidebar.js"></script>
  </div>
</body>
</html>
